<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Convertit un programme de formats SAS — from_pgm • fmtsas</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Convertit un programme de formats SAS — from_pgm" />
<meta property="og:description" content="Convertit les données contenues dans les proc format d'un programme SAS en
une liste de vecteurs qui pourra servir à effectuer des conversions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fmtsas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/InseeFrLab/fmtsas">
    <span class="fab fa-github fa-lg"></span>
     
    Contribuer
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Convertit un programme de formats SAS</h1>
    <small class="dont-index">Source: <a href='https://github.com/InseeFrLab/fmtsas/blob/master/R/from_pgm.R'><code>R/from_pgm.R</code></a></small>
    <div class="hidden name"><code>from_pgm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convertit les données contenues dans les <code>proc format</code> d'un programme SAS en
une liste de vecteurs qui pourra servir à effectuer des conversions.</p>
    </div>

    <pre class="usage"><span class='fu'>from_pgm</span><span class='op'>(</span><span class='va'>sas_pgm</span>, quote <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"double"</span>, <span class='st'>"simple"</span><span class='op'>)</span>, source <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sas_pgm</th>
      <td><p>un programme SAS sous la forme d'un vecteur de chaînes de
caractères.</p></td>
    </tr>
    <tr>
      <th>quote</th>
      <td><p>type de guillemet. SAS autorise deux types de guillemets pour
décrire une chaîne de caractères. La fonction suppose que des guillemets
doubles sont utilisés ("). Dans le cas contraire ('), spécifier
<code>quote = "simple"</code>.</p></td>
    </tr>
    <tr>
      <th>source</th>
      <td><p>conserver le code SAS dans un attribut <code>"source"</code> de l'objet
en sortie.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Une liste contenant autant d'éléments que de formats si les données
avaient été générées par SAS via une <code>proc format</code>.</p><ul>
<li><p>les noms de la liste correspondent aux noms des formats (<code>value $...</code>) ;</p></li>
<li><p>les éléments de la liste sont des vecteurs contenant les relations entre
valeurs initiales et valeurs converties ;</p></li>
<li><p>chaque élément a un éventuel attribut <code>"other"</code> ;</p></li>
<li><p>chaque élément est un objet de type <code><a href='fmtsas_c.html'>fmtsas_c</a></code>, ce qui permet
d'utiliser l'<a href='extract.fmtsas_c.html'>opérateur de sélection</a> avec prise en
compte d'une valeur par défaut (<code>other</code>).</p></li>
</ul>

<p>Voir les exemples pour l'utilisation de cette liste.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>La fonction ne recherche que les formats de type caractère (<code>value $nom</code>).
Les formats numériques sont ignorés (un message d'avertissement dresse une
liste de ces formats, s'ils sont présents).</p>
<p>Le programme peut se présenter sous la forme d'une chaîne unique de
caractères mais aussi d'un vecteur de plusieurs chaînes (typiquement le
résultat de la lecture d'un fichier par <a href='https://rdrr.io/r/base/readLines.html'>readLines</a>). Les commentaires,
espaces et sauts de lignes surnuméraires sont autorisés. La casse du code SAS
(majuscule ou minuscule) est sans importance. Le programme peut en outre
contenir autre chose que des <code>proc format</code>.</p>
<p>La fonction détecte plusieurs valeurs séparées par des virgules à gauche du
signe <code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code>. En revanche, les intervalles de caractères (type <code>"A"-"Z"</code>) ne
sont pas gérés car ils contiennent un nombre indéfini de modalités possibles.
Les bornes de l'intervalle seront toutefois prises en compte (comme si
<code>"A","Z"</code> était écrit). La syntaxe sans les guillements (<code>A-Z</code>), également
permise par SAS, n'est <strong>pas prise en compte</strong> et ces intervalles seront
ignorés.</p>
<p>Il est possible de choisir le type de guillemets (double ou simple) entourant
les valeurs. Avec un programme contenant un mélange de guillemets simples et
doubles, la fonction ne détectera qu'un type et pas l'autre.</p>
<p>La modalité SAS <code>other</code> (valeur par défaut) est sauvegardée dans l'attribut
"other" pour chaque élément de la liste. Si le format SAS n'a pas de valeur
par défaut, l'attribut n'est pas présent.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='from_tab.html'>from_tab</a> pour importer les formats contenus dans une table SAS.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Import d'un programme SAS :</span>

<span class='va'>test_pgm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/pgm_format_test.sas"</span>, package <span class='op'>=</span> <span class='st'>"fmtsas"</span><span class='op'>)</span>,
  encoding <span class='op'>=</span> <span class='st'>"UTF-8"</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='va'>test_pgm</span>, sep <span class='op'>=</span> <span class='st'>"\n"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; proc format ;
#&gt; 
#&gt;   /* Noms régions */
#&gt;   value $reg
#&gt;   "01" = "Guadeloupe"
#&gt;   "02" = "Martinique"
#&gt;   "03" = "Guyane"
#&gt;   "04" = "La Réunion"
#&gt;   "06" = "Mayotte"
#&gt;   "11" = "Île-de-France"
#&gt;   "24" = "Centre-Val de Loire"
#&gt;   "27" = "Bourgogne-Franche-Comté"
#&gt;   "28" = "Normandie"
#&gt;   "32" = "Hauts-de-France"
#&gt;   "44" = "Grand Est"
#&gt;   "52" = "Pays de la Loire"
#&gt;   "53" = "Bretagne"
#&gt;   "75" = "Nouvelle Aquitaine"
#&gt;   "76" = "Occitanie"
#&gt;   "84" = "Auvergne-Rhône-Alpes"
#&gt;   "93" = "Provence-Alpes-Côte d'Azur"
#&gt;   "94" = "Corse" ;
#&gt; 
#&gt;   /* Secteur d'activité regroupé */
#&gt;   value $a13_
#&gt;   "B", "C", "D", "E" = "Industrie"
#&gt;   "F"                = "Construction"
#&gt;   "G"                = "Commerce, réparation d'automobiles et de motocycles"
#&gt;   "H"                = "Transports et entreposage"
#&gt;   "I"                = "Hébergement et restauration"
#&gt;   "J"                = "Information et communication"
#&gt;   "K", "L"           = "Activités financières, d'assurance et immobilières"
#&gt;   "M"                = "Activités spécialisées, scientifiques et techniques"
#&gt;   "N"                = "Activités de services administratifs et de soutien"
#&gt;   "P"                = "Enseignement"
#&gt;   "Q"                = "Santé humaine et action sociale"
#&gt;   other              = "Hors champ" ;
#&gt; 
#&gt; run ;
#&gt; 
#&gt; PROC FORMAT;VALUE $ sexe  "1"="Homme"    "2"="Femme" ;RUN;
#&gt; 
#&gt; data t1 ;
#&gt;   set t2 ;
#&gt;   GEO2 = put(REG2016, $reg.) ;
#&gt;   A13 = put(A21, $a13_.) ;
#&gt; run ;</div><div class='input'>
<span class='co'>## Conversion des formats :</span>

<span class='va'>conv</span> <span class='op'>&lt;-</span> <span class='fu'>from_pgm</span><span class='op'>(</span><span class='va'>test_pgm</span><span class='op'>)</span>
<span class='va'>conv</span>
</div><div class='output co'>#&gt; $reg
#&gt; # a character `fmtsas` object
#&gt;                           01                           02 
#&gt;                 "Guadeloupe"                 "Martinique" 
#&gt;                           03                           04 
#&gt;                     "Guyane"                 "La Réunion" 
#&gt;                           06                           11 
#&gt;                    "Mayotte"              "Île-de-France" 
#&gt;                           24                           27 
#&gt;        "Centre-Val de Loire"    "Bourgogne-Franche-Comté" 
#&gt;                           28                           32 
#&gt;                  "Normandie"            "Hauts-de-France" 
#&gt;                           44                           52 
#&gt;                  "Grand Est"           "Pays de la Loire" 
#&gt;                           53                           75 
#&gt;                   "Bretagne"         "Nouvelle Aquitaine" 
#&gt;                           76                           84 
#&gt;                  "Occitanie"       "Auvergne-Rhône-Alpes" 
#&gt;                           93                           94 
#&gt; "Provence-Alpes-Côte d'Azur"                      "Corse" 
#&gt; 
#&gt; $a13_
#&gt; # a character `fmtsas` object
#&gt;                                                     B 
#&gt;                                           "Industrie" 
#&gt;                                                     C 
#&gt;                                           "Industrie" 
#&gt;                                                     D 
#&gt;                                           "Industrie" 
#&gt;                                                     E 
#&gt;                                           "Industrie" 
#&gt;                                                     F 
#&gt;                                        "Construction" 
#&gt;                                                     G 
#&gt; "Commerce, réparation d'automobiles et de motocycles" 
#&gt;                                                     H 
#&gt;                           "Transports et entreposage" 
#&gt;                                                     I 
#&gt;                         "Hébergement et restauration" 
#&gt;                                                     J 
#&gt;                        "Information et communication" 
#&gt;                                                     K 
#&gt;  "Activités financières, d'assurance et immobilières" 
#&gt;                                                     L 
#&gt;  "Activités financières, d'assurance et immobilières" 
#&gt;                                                     M 
#&gt; "Activités spécialisées, scientifiques et techniques" 
#&gt;                                                     N 
#&gt;  "Activités de services administratifs et de soutien" 
#&gt;                                                     P 
#&gt;                                        "Enseignement" 
#&gt;                                                     Q 
#&gt;                     "Santé humaine et action sociale" 
#&gt; [other] "Hors champ"
#&gt; $sexe
#&gt; # a character `fmtsas` object
#&gt;       1       2 
#&gt; "Homme" "Femme" 
#&gt; </div><div class='input'>
<span class='co'>## Utilisation :</span>

<span class='co'># soit un jeu de donnees contenant des codes a convertir en libelles</span>
<span class='va'>donnees</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
    ACT_CODE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='st'>"B"</span>,   <span class='cn'>NA</span>,  <span class='st'>"C"</span>,  <span class='st'>"P"</span>,  <span class='st'>"W"</span>, <span class='st'>"F"</span><span class='op'>)</span>,
    REG_CODE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"94"</span>, <span class='st'>"04"</span>, <span class='st'>"44"</span>, <span class='st'>"09"</span>, <span class='st'>"01"</span>,  <span class='cn'>NA</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='co'># pour remplacer les codes par les libelles (pour ACT_CODE)</span>
<span class='va'>donnees</span><span class='op'>$</span><span class='va'>ACT_LIB</span>  <span class='op'>&lt;-</span> <span class='va'>conv</span><span class='op'>$</span><span class='va'>a13_</span><span class='op'>[</span><span class='va'>donnees</span><span class='op'>$</span><span class='va'>ACT_CODE</span><span class='op'>]</span>
<span class='va'>donnees</span><span class='op'>$</span><span class='va'>ACT_LIB2</span> <span class='op'>&lt;-</span> <span class='va'>conv</span><span class='op'>$</span><span class='va'>a13_</span><span class='op'>[</span><span class='va'>donnees</span><span class='op'>$</span><span class='va'>ACT_CODE</span>, keep_na <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>]</span>
<span class='va'>donnees</span><span class='op'>$</span><span class='va'>REG_LIB</span>  <span class='op'>&lt;-</span> <span class='va'>conv</span><span class='op'>$</span><span class='va'>reg</span><span class='op'>[</span><span class='va'>donnees</span><span class='op'>$</span><span class='va'>REG_CODE</span><span class='op'>]</span>

<span class='va'>donnees</span>
</div><div class='output co'>#&gt;   ACT_CODE REG_CODE      ACT_LIB     ACT_LIB2    REG_LIB
#&gt; 1        B       94    Industrie    Industrie      Corse
#&gt; 2     &lt;NA&gt;       04   Hors champ         &lt;NA&gt; La Réunion
#&gt; 3        C       44    Industrie    Industrie  Grand Est
#&gt; 4        P       09 Enseignement Enseignement         09
#&gt; 5        W       01   Hors champ   Hors champ Guadeloupe
#&gt; 6        F     &lt;NA&gt; Construction Construction       &lt;NA&gt;</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pierre-Yves Berrard.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


